---
title: "Lab4"
format: html
editor: visual
---

## Quarto

```{r}
library(ggplot2)
library(dplyr)
```

```{r}
data <- read.csv("berkeley.csv")
```

```{r}
filtered_data <- data %>%
  filter(Major != "Other")
```

```{r}
ggplot(filtered_data, aes(x = Major, fill = Admission))+
  geom_bar(color="darkblue") + 
  geom_text(stat = "count", aes(label = after_stat(count)), 
    position = position_stack(vjust = 0.5), color = "white")+
  labs(title = "Distribution of Students enrolled in UC Berkeley in 1973", x = "Major", y = "Number of Students",
      fill = "Admission")
```

```{r}
ggplot(filtered_data, aes(y = Major)) + 
  geom_bar(aes(fill = Gender), position = position_dodge(0.9)) +
  geom_bar(fill = NA, color = "darkblue") +
  geom_text(stat = "count", 
            aes(label = after_stat(count), group = Gender),
            position = position_dodge(width = 0.9), 
            hjust = -0.2) +
  labs(title = "Distribution of Students by Major",
       x = "Count", 
       y = "Major",
       fill = "Gender")
```

```{r}
ggplot(filtered_data, aes(y = Major)) + 
  geom_bar(aes(fill = Admission), position = "dodge") +
  geom_bar(fill = NA, color = "darkblue") +
  labs(title = "Distribution of Students by Major",
       x = "Count", 
       y = "Major",
       fill = "Admission status")
```

```{r}
ggplot(filtered_data, aes(y = Major, fill = Admission)) + 
  geom_bar(aes(group = Gender), position = position_dodge(0.9)) +
  geom_bar(fill = NA, color = "darkblue") +
  geom_text(stat = "count", 
            aes(label = after_stat(count), group = Gender),
            position = position_dodge(width = 0.9), 
            hjust = -0.2) +
  labs(title = "Distribution of Students by Major",
       x = "Count", 
       y = "Major",
       fill = "Admission status") +
  facet_wrap(~ Gender)
```

```{r}
# Create a combined Major_Gender variable for the x-axis
filtered_data$Major_Gender <- interaction(filtered_data$Major, filtered_data$Gender, sep = " - ")

ggplot(filtered_data, aes(x = Major_Gender, fill = Admission)) + 
  geom_bar(color = "darkblue") +
  geom_text(stat = "count", 
            aes(label = after_stat(count)),
            position = position_stack(vjust = 0.5),
            color = "white") +
  labs(title = "Distribution of Students by Major and Gender",
       x = "Major - Gender", 
       y = "Count",
       fill = "Admission status") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate x-axis labels for readability
```

```{r}
# Load necessary libraries
library(ggplot2)

# VADeaths is a built-in dataset in R
data("VADeaths")

# Convert the dataset to a format suitable for ggplot2
df <- as.data.frame(VADeaths)
df$age <- rownames(df)

# Reshape the data from wide to long format
library(tidyr)
df_long <- pivot_longer(df, cols = -age, 
                       names_to = "demographic", 
                       values_to = "death_rate")

# Create a line chart
ggplot(df_long, aes(x = age, y = death_rate, color = demographic, 
                    group = demographic, 
                    linetype = ifelse(grepl("Female", demographic), "dashed", "solid"))) +
  geom_line(linewidth = 1) +
  geom_point(size = 3) +
  scale_linetype_identity() +  # Use the actual values "dotted" and "solid"
  theme_minimal() +
  labs(title = "Death Rates in Virginia (1940)",
       x = "Age Group",
       y = "Deaths per 1,000 Population",
       color = "Demographic Group")
```
